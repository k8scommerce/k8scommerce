info(
	title: "User API Endpoints"
	desc: "admin gateway user api endpoints"
	author: "localrivet"
	email: "localrivet"
	version: "1"
)

// objects
type User {
	Id         int64             `json:"id"`                   // user id
	FirstName  string            `json:"firstName"`            // first name
	LastName   string            `json:"lastName"`             // last name
	Email      string            `json:"email"`                // email address
	Password   string            `json:"password,optional"`   // password
	// Attributes map[string]string `json:"attributes,optional"` // password
}

type PermissionGroup {
	Id        int64  `json:"id"`        // permission group id
	GroupName string `json:"groupName"` // groupName
}

type UsersPermissionGroups {
	UserId            int64 `json:"userId"`            // user id
	PermissionGroupId int64 `json:"permissionGroupId"` // permission group id
}

//
// requests & responses
//

// login
type UserLoginRequest {
	Email    string `json:"email"`    // email address
	Password string `json:"password"` // password
}

type UserLoginResponse {
	JwtToken JwtToken `json:"jwt"` // JwtToken object
	User 	 User 	  `json:"user"` // User object
}

// get all users
type GetAllUsersRequest {
	CurrentPage int64  `path:"currentPage"`
	PageSize    int64  `path:"pageSize"`
	SortOn      string `form:"sortOn,optional"`
}

type GetAllUsersResponse {
	Users        []User `json:"users"`
	TotalRecords int64  `json:"totalRecords"`
	TotalPages   int64  `json:"totalPages"`
}
//
// endpoints
//

@server(
	middleware: Locale
	group: users
)
service admin {
	// login
	@doc(
		summary: "Login"
		description: "login for administration users"
	)
	@handler login
	post /v1/user/login(UserLoginRequest) returns (UserLoginResponse)
}

@server(
	// jwt: Auth
	middleware: Locale
	group: users
)
service admin {
	// get all users
	@doc(
		summary: "Get Users"
		description: "returns all users"
		currentPage: "current page number"
		pageSize: "number of records per page"
	)
	@handler getAllUsers
	get /v1/users/:currentPage/:pageSize(GetAllUsersRequest) returns (GetAllUsersResponse)
	
	// rpc GetAllPermissionGroups(GetAllPermissionGroupsRequest) returns (GetAllPermissionGroupsResponse);
	
}